From: thermatk <thermatk@thermatk.com>
Date: Fri, 22 Jun 2018 17:05:17 +0200
Subject: kill Location, fall back to system

License: GPL-3.0-only - https://spdx.org/licenses/GPL-3.0-only.html
---
 services/device/geolocation/BUILD.gn                          | 1 -
 .../chromium/device/geolocation/LocationProviderFactory.java  | 4 +++-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/services/device/geolocation/BUILD.gn b/services/device/geolocation/BUILD.gn
--- a/services/device/geolocation/BUILD.gn
+++ b/services/device/geolocation/BUILD.gn
@@ -165,7 +165,6 @@ if (is_android) {
       "android/java/src/org/chromium/device/geolocation/LocationProviderAdapter.java",
       "android/java/src/org/chromium/device/geolocation/LocationProviderAndroid.java",
       "android/java/src/org/chromium/device/geolocation/LocationProviderFactory.java",
-      "android/java/src/org/chromium/device/geolocation/LocationProviderGmsCore.java",
     ]
 
     deps = [
diff --git a/services/device/geolocation/android/java/src/org/chromium/device/geolocation/LocationProviderFactory.java b/services/device/geolocation/android/java/src/org/chromium/device/geolocation/LocationProviderFactory.java
--- a/services/device/geolocation/android/java/src/org/chromium/device/geolocation/LocationProviderFactory.java
+++ b/services/device/geolocation/android/java/src/org/chromium/device/geolocation/LocationProviderFactory.java
@@ -26,11 +26,13 @@ public class LocationProviderFactory {
 
     @CalledByNative
     public static void useGmsCoreLocationProvider() {
-        sUseGmsCoreLocationProvider = true;
+        sUseGmsCoreLocationProvider = false;
     }
 
     public static LocationProvider create() {
         if (sProviderImpl != null) return sProviderImpl;
+        sProviderImpl = new LocationProviderAndroid();
+        return sProviderImpl;
 
         if (sUseGmsCoreLocationProvider
                 && LocationProviderGmsCore.isGooglePlayServicesAvailable(
--
2.25.1
