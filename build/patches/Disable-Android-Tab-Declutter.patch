From: uazo <uazo@users.noreply.github.com>
Date: Tue, 1 Apr 2025 11:37:52 +0000
Subject: Disable Android Tab Declutter

Original License: GPL-2.0-or-later - https://spdx.org/licenses/GPL-2.0-or-later.html
License: GPL-3.0-only - https://spdx.org/licenses/GPL-3.0-only.html
---
 .../org/chromium/chrome/browser/tab/TabArchiveSettings.java    | 3 ++-
 .../chrome_feature_list_cc/Disable-Android-Tab-Declutter.inc   | 1 +
 2 files changed, 3 insertions(+), 1 deletion(-)
 create mode 100644 cromite_flags/chrome/browser/flags/android/chrome_feature_list_cc/Disable-Android-Tab-Declutter.inc

diff --git a/chrome/android/java/src/org/chromium/chrome/browser/tab/TabArchiveSettings.java b/chrome/android/java/src/org/chromium/chrome/browser/tab/TabArchiveSettings.java
--- a/chrome/android/java/src/org/chromium/chrome/browser/tab/TabArchiveSettings.java
+++ b/chrome/android/java/src/org/chromium/chrome/browser/tab/TabArchiveSettings.java
@@ -104,11 +104,12 @@ public class TabArchiveSettings {
         // are created, and tabs disappearing from tests is very unexpected. For archive tests,
         // this will need to be turned on manually.
         return mPrefsManager.readBoolean(
-                ChromePreferenceKeys.TAB_DECLUTTER_ARCHIVE_ENABLED, !BuildConfig.IS_FOR_TEST);
+                ChromePreferenceKeys.TAB_DECLUTTER_ARCHIVE_ENABLED, false);
     }
 
     /** Sets whether archive is enabled in settings. */
     public void setArchiveEnabled(boolean enabled) {
+        enabled = false;
         mPrefsManager.writeBoolean(ChromePreferenceKeys.TAB_DECLUTTER_ARCHIVE_ENABLED, enabled);
     }
 
diff --git a/cromite_flags/chrome/browser/flags/android/chrome_feature_list_cc/Disable-Android-Tab-Declutter.inc b/cromite_flags/chrome/browser/flags/android/chrome_feature_list_cc/Disable-Android-Tab-Declutter.inc
new file mode 100644
--- /dev/null
+++ b/cromite_flags/chrome/browser/flags/android/chrome_feature_list_cc/Disable-Android-Tab-Declutter.inc
@@ -0,0 +1 @@
+SET_CROMITE_FEATURE_DISABLED(kAndroidTabDeclutter);
--
